---
layout: post
title: Visual Studio 2008 templates compliant with Microsoft StyleCop
tags:
- ASP.Net MVC
- Code Quality
- StyleCop
- Visual Studio
status: publish
type: post
published: true
meta:
  _edit_last: '6'
  _edit_lock: '1231662075'
---
<h2>Motivation</h2>  <p>Since Microsoft launched <a title="StyleCop" href="http://code.msdn.microsoft.com/sourceanalysis" target="_blank">StyleCop</a>, we are running this tool in all <strong>Southworks'</strong> projects. From our <strong>Engineering Excellence</strong> department we&#8217;re promoting the use of this tool because it give us source code consistency and homogeneity we want for developers and customers who read the code.</p>  <p>If you're using this tool, you surely be realized that some <strong>Visual Studio</strong> templates are not compliant with some of the <a title="StyleCop" href="http://code.msdn.microsoft.com/sourceanalysis" target="_blank">StyleCop</a> rules, like using directives inside the namespaces, regions, one class for each file, among others. This is quite annoying when you&#8217;re coding because each class, interface or test you add to your project has to be stylized to meet that rules. </p>  <p>Project templates like <b>ASP.Net Web MVC Application (Preview 5)</b> have an amount of <b>~120</b> warning even avoiding the documentation rules. </p>  <p>The purpose of this post is to give you a workaround to avoid this unnecessary work.</p>  <p><b></b></p>  <h2>Context</h2>  <p>The way that <strong>Visual Studio</strong> provides these templates is by using a series of compressed zip files, with the base source code inside.</p>  <p>There are two folders inside the <em>&#8220;</em><b><em>%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE\&#8221;</em> </b>with these templates, one for the items (classes, interfaces, tests, etc.) and one for projects (Class Library, Console Application, MVC Web Application, etc.).</p>  <p><b></b></p>  <h2>Workaround</h2>  <p>The workaround is pretty much straightforward, all you have to do is:</p>  <ol>   <li>Extract the default Visual Studio template files </li>    <li>Modify them to be compliant </li>    <li>Compress it again </li>    <li>and overwrite the original files </li> </ol>  <p>What I did this weekend, is make the work for you for the most used files and projects for me including the <a title="Microsoft ASP.Net MVC preview 5" href="http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=16775" target="_blank">Microsoft ASP.Net MVC preview 5</a> project template :). So below you&#8217;ll find a table with the zip files to download and the folder location where you will overwrite them.</p>  <p>Once you have copied the files, ensure you&#8217;ve all you Visual Studio instances closed and run as administrator from the console the following command to refresh Visual Studio's template cache:</p>  <p><b><i>&#8220;%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE\devenv.com&quot; /setup&quot;</i></b></p>  <h2>Template Files</h2>  <p><strong>(*) rootPath = &quot;</strong>%ProgramFiles%\Microsoft Visual Studio 9.0\Common7\IDE\&quot;</p>  <table cellspacing="0" cellpadding="2" width="575" border="0"><tbody>     <tr>       <td style="font-weight: bold;color: #fff" width="231">template path </td>        <td style="font-weight: bold;color: #fff" width="342">template file </td>     </tr>      <tr>       <td style="vertical-align: middle" width="231">         <p><strong>(*)</strong>\ItemTemplates\CSharp\Web\MVC\1033</p>       </td>        <td style="vertical-align: middle" valign="top" width="342">         <ul>           <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcviewpageitemtemplatep5cs.zip" target="_blank">MvcViewPageItemTemplateP5.cs.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcviewusercontrolitemtemplatep5cs.zip" target="_blank">MvcViewUserControlItemTemplateP5.cs.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvccontrolleritemtemplatep5cs.zip" target="_blank">MvcControllerItemTemplateP5.cs.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcviewcontentpageitemtemplatep5cs.zip" target="_blank">MvcViewContentPageItemTemplateP5.cs.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcviewmasterpageitemtemplatep5cs.zip" target="_blank">MvcViewMasterPageItemTemplateP5.cs.zip</a> </li>         </ul>       </td>     </tr>      <tr>       <td style="vertical-align: middle" width="231">         <p><strong>(*)</strong>\ItemTemplates\CSharp\1033</p>       </td>        <td style="vertical-align: middle" valign="top" width="342">         <ul>           <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/simpleunittest.zip" target="_blank">SimpleUnitTest.zip</a> </li>         </ul>       </td>     </tr>      <tr>       <td style="vertical-align: middle" width="231">         <p><strong>(*)</strong>\ItemTemplates\CSharp\Code\1033</p>       </td>        <td style="vertical-align: middle" valign="top" width="342">         <ul>           <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/netcfv2-class.zip" target="_blank">NETCFv2-Class.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/interface.zip" target="_blank">Interface.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/class.zip" target="_blank">Class.zip</a> </li>            <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/codefile.zip" target="_blank">CodeFile.zip</a> </li>         </ul>       </td>     </tr>      <tr>       <td style="vertical-align: middle" width="231">         <p><strong>(*)</strong>\ProjectTemplates\CSharp\Web\1033</p>       </td>        <td style="vertical-align: middle" valign="top" width="342">         <ul>           <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcwebapplicationprojecttemplatep5cs.zip" target="_blank">MvcWebApplicationProjectTemplateP5.cs.zip</a> </li>         </ul>       </td>     </tr>      <tr>       <td style="vertical-align: middle" width="231">         <p><strong>(*)</strong>\ProjectTemplates\CSharp\Test\1033</p>       </td>        <td style="vertical-align: middle" valign="top" width="342">         <ul>           <li><a href="http://blogs.southworks.net/jpgarcia/files/2008/09/mvcwebapplicationtestprojecttemplatep5cs.zip" target="_blank">MvcWebApplicationTestProjectTemplateP5.cs.zip</a> </li>         </ul>       </td>     </tr>   </tbody></table>  <p>You can also download all templates in a single .zip file: <a href="http://blogs.southworks.net/jpgarcia/files/2008/09/alltemplates.zip" target="_blank">AllTemplates.zip</a></p>
